{"ast":null,"code":"var _jsxFileName = \"/Users/chandrasekhar/Desktop/GlobalIP2/GlobalIp/GlobalIpFrontend/src/components/OAuth2RedirectHandler.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport axios from '../api/axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function OAuth2RedirectHandler() {\n  _s();\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  useEffect(() => {\n    // Check both query params and hash fragment\n    const hash = window.location.hash.substring(1);\n    const hashParams = new URLSearchParams(hash);\n\n    // Try multiple possible parameter names from query string\n    let token = searchParams.get('token') || searchParams.get('accessToken') || searchParams.get('access_token') || searchParams.get('jwt');\n\n    // If not in query params, check hash fragment\n    if (!token) {\n      token = hashParams.get('token') || hashParams.get('accessToken') || hashParams.get('access_token') || hashParams.get('jwt');\n    }\n    const error = searchParams.get('error') || hashParams.get('error');\n    console.log('OAuth2 Redirect - Full URL:', window.location.href);\n    console.log('OAuth2 Redirect - Hash:', window.location.hash);\n    console.log('OAuth2 Redirect - Token:', token);\n    console.log('OAuth2 Redirect - Error:', error);\n    console.log('OAuth2 Redirect - Query params:', Object.fromEntries(searchParams));\n    console.log('OAuth2 Redirect - Hash params:', Object.fromEntries(hashParams));\n    if (token) {\n      // Token received from backend OAuth2 redirect\n      console.log('Token received:', token);\n\n      // Store token\n      localStorage.setItem('token', token);\n      localStorage.setItem('loggedIn', 'true');\n      try {\n        // Decode JWT to extract user info\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        console.log('Decoded JWT payload:', payload);\n\n        // Extract user info from JWT payload\n        // JWT typically has: sub (email), role, exp, iat\n        const email = payload.sub || payload.email;\n        const role = payload.role || 'USER';\n        const username = payload.username || email.split('@')[0];\n        console.log('Extracted user info:', {\n          username,\n          email,\n          role\n        });\n        localStorage.setItem('role', role);\n        localStorage.setItem('user', JSON.stringify({\n          username,\n          email,\n          role\n        }));\n\n        // Navigate based on role\n        console.log('Navigating to dashboard for role:', role);\n        if (role === 'ADMIN') {\n          navigate('/admindashboard');\n        } else if (role === 'ANALYST') {\n          navigate('/analystdashboard');\n        } else {\n          navigate('/userdashboard');\n        }\n      } catch (err) {\n        console.error('Failed to decode token:', err);\n        alert('Login successful but failed to process token. Please try again.');\n        navigate('/');\n      }\n    } else if (error) {\n      console.error('OAuth2 error received:', error);\n      alert(`OAuth2 login failed: ${error}`);\n      navigate('/');\n    } else {\n      console.log('No token or error found, redirecting to home');\n      navigate('/');\n    }\n  }, [searchParams, navigate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen flex items-center justify-center bg-gradient-to-br from-yellow-100 via-white to-yellow-200\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-16 w-16 border-t-4 border-yellow-500 mx-auto mb-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-700 font-semibold\",\n        children: \"Completing login...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n}\n_s(OAuth2RedirectHandler, \"BL0/uIvqgnY+m2kKjm25nXv/8uc=\", false, function () {\n  return [useNavigate, useSearchParams];\n});\n_c = OAuth2RedirectHandler;\nvar _c;\n$RefreshReg$(_c, \"OAuth2RedirectHandler\");","map":{"version":3,"names":["useEffect","useNavigate","useSearchParams","axios","jsxDEV","_jsxDEV","OAuth2RedirectHandler","_s","navigate","searchParams","hash","window","location","substring","hashParams","URLSearchParams","token","get","error","console","log","href","Object","fromEntries","localStorage","setItem","payload","JSON","parse","atob","split","email","sub","role","username","stringify","err","alert","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/chandrasekhar/Desktop/GlobalIP2/GlobalIp/GlobalIpFrontend/src/components/OAuth2RedirectHandler.jsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport axios from '../api/axios';\n\nexport default function OAuth2RedirectHandler() {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n\n  useEffect(() => {\n    // Check both query params and hash fragment\n    const hash = window.location.hash.substring(1);\n    const hashParams = new URLSearchParams(hash);\n    \n    // Try multiple possible parameter names from query string\n    let token = searchParams.get('token') || \n                searchParams.get('accessToken') || \n                searchParams.get('access_token') ||\n                searchParams.get('jwt');\n    \n    // If not in query params, check hash fragment\n    if (!token) {\n      token = hashParams.get('token') || \n              hashParams.get('accessToken') || \n              hashParams.get('access_token') ||\n              hashParams.get('jwt');\n    }\n    \n    const error = searchParams.get('error') || hashParams.get('error');\n\n    console.log('OAuth2 Redirect - Full URL:', window.location.href);\n    console.log('OAuth2 Redirect - Hash:', window.location.hash);\n    console.log('OAuth2 Redirect - Token:', token);\n    console.log('OAuth2 Redirect - Error:', error);\n    console.log('OAuth2 Redirect - Query params:', Object.fromEntries(searchParams));\n    console.log('OAuth2 Redirect - Hash params:', Object.fromEntries(hashParams));\n\n    if (token) {\n      // Token received from backend OAuth2 redirect\n      console.log('Token received:', token);\n      \n      // Store token\n      localStorage.setItem('token', token);\n      localStorage.setItem('loggedIn', 'true');\n\n      try {\n        // Decode JWT to extract user info\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        console.log('Decoded JWT payload:', payload);\n        \n        // Extract user info from JWT payload\n        // JWT typically has: sub (email), role, exp, iat\n        const email = payload.sub || payload.email;\n        const role = payload.role || 'USER';\n        const username = payload.username || email.split('@')[0];\n        \n        console.log('Extracted user info:', { username, email, role });\n        \n        localStorage.setItem('role', role);\n        localStorage.setItem('user', JSON.stringify({ username, email, role }));\n\n        // Navigate based on role\n        console.log('Navigating to dashboard for role:', role);\n        if (role === 'ADMIN') {\n          navigate('/admindashboard');\n        } else if (role === 'ANALYST') {\n          navigate('/analystdashboard');\n        } else {\n          navigate('/userdashboard');\n        }\n      } catch (err) {\n        console.error('Failed to decode token:', err);\n        alert('Login successful but failed to process token. Please try again.');\n        navigate('/');\n      }\n    } else if (error) {\n      console.error('OAuth2 error received:', error);\n      alert(`OAuth2 login failed: ${error}`);\n      navigate('/');\n    } else {\n      console.log('No token or error found, redirecting to home');\n      navigate('/');\n    }\n  }, [searchParams, navigate]);\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-yellow-100 via-white to-yellow-200\">\n      <div className=\"text-center\">\n        <div className=\"animate-spin rounded-full h-16 w-16 border-t-4 border-yellow-500 mx-auto mb-4\"></div>\n        <p className=\"text-gray-700 font-semibold\">Completing login...</p>\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;AAAA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,WAAW,EAAEC,eAAe,QAAQ,kBAAkB;AAC/D,OAAOC,KAAK,MAAM,cAAc;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEjC,eAAe,SAASC,qBAAqBA,CAAA,EAAG;EAAAC,EAAA;EAC9C,MAAMC,QAAQ,GAAGP,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACQ,YAAY,CAAC,GAAGP,eAAe,CAAC,CAAC;EAExCF,SAAS,CAAC,MAAM;IACd;IACA,MAAMU,IAAI,GAAGC,MAAM,CAACC,QAAQ,CAACF,IAAI,CAACG,SAAS,CAAC,CAAC,CAAC;IAC9C,MAAMC,UAAU,GAAG,IAAIC,eAAe,CAACL,IAAI,CAAC;;IAE5C;IACA,IAAIM,KAAK,GAAGP,YAAY,CAACQ,GAAG,CAAC,OAAO,CAAC,IACzBR,YAAY,CAACQ,GAAG,CAAC,aAAa,CAAC,IAC/BR,YAAY,CAACQ,GAAG,CAAC,cAAc,CAAC,IAChCR,YAAY,CAACQ,GAAG,CAAC,KAAK,CAAC;;IAEnC;IACA,IAAI,CAACD,KAAK,EAAE;MACVA,KAAK,GAAGF,UAAU,CAACG,GAAG,CAAC,OAAO,CAAC,IACvBH,UAAU,CAACG,GAAG,CAAC,aAAa,CAAC,IAC7BH,UAAU,CAACG,GAAG,CAAC,cAAc,CAAC,IAC9BH,UAAU,CAACG,GAAG,CAAC,KAAK,CAAC;IAC/B;IAEA,MAAMC,KAAK,GAAGT,YAAY,CAACQ,GAAG,CAAC,OAAO,CAAC,IAAIH,UAAU,CAACG,GAAG,CAAC,OAAO,CAAC;IAElEE,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAET,MAAM,CAACC,QAAQ,CAACS,IAAI,CAAC;IAChEF,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAET,MAAM,CAACC,QAAQ,CAACF,IAAI,CAAC;IAC5DS,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEJ,KAAK,CAAC;IAC9CG,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEF,KAAK,CAAC;IAC9CC,OAAO,CAACC,GAAG,CAAC,iCAAiC,EAAEE,MAAM,CAACC,WAAW,CAACd,YAAY,CAAC,CAAC;IAChFU,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEE,MAAM,CAACC,WAAW,CAACT,UAAU,CAAC,CAAC;IAE7E,IAAIE,KAAK,EAAE;MACT;MACAG,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEJ,KAAK,CAAC;;MAErC;MACAQ,YAAY,CAACC,OAAO,CAAC,OAAO,EAAET,KAAK,CAAC;MACpCQ,YAAY,CAACC,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC;MAExC,IAAI;QACF;QACA,MAAMC,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACb,KAAK,CAACc,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrDX,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEM,OAAO,CAAC;;QAE5C;QACA;QACA,MAAMK,KAAK,GAAGL,OAAO,CAACM,GAAG,IAAIN,OAAO,CAACK,KAAK;QAC1C,MAAME,IAAI,GAAGP,OAAO,CAACO,IAAI,IAAI,MAAM;QACnC,MAAMC,QAAQ,GAAGR,OAAO,CAACQ,QAAQ,IAAIH,KAAK,CAACD,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAExDX,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAE;UAAEc,QAAQ;UAAEH,KAAK;UAAEE;QAAK,CAAC,CAAC;QAE9DT,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEQ,IAAI,CAAC;QAClCT,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEE,IAAI,CAACQ,SAAS,CAAC;UAAED,QAAQ;UAAEH,KAAK;UAAEE;QAAK,CAAC,CAAC,CAAC;;QAEvE;QACAd,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAEa,IAAI,CAAC;QACtD,IAAIA,IAAI,KAAK,OAAO,EAAE;UACpBzB,QAAQ,CAAC,iBAAiB,CAAC;QAC7B,CAAC,MAAM,IAAIyB,IAAI,KAAK,SAAS,EAAE;UAC7BzB,QAAQ,CAAC,mBAAmB,CAAC;QAC/B,CAAC,MAAM;UACLA,QAAQ,CAAC,gBAAgB,CAAC;QAC5B;MACF,CAAC,CAAC,OAAO4B,GAAG,EAAE;QACZjB,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEkB,GAAG,CAAC;QAC7CC,KAAK,CAAC,iEAAiE,CAAC;QACxE7B,QAAQ,CAAC,GAAG,CAAC;MACf;IACF,CAAC,MAAM,IAAIU,KAAK,EAAE;MAChBC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC9CmB,KAAK,CAAC,wBAAwBnB,KAAK,EAAE,CAAC;MACtCV,QAAQ,CAAC,GAAG,CAAC;IACf,CAAC,MAAM;MACLW,OAAO,CAACC,GAAG,CAAC,8CAA8C,CAAC;MAC3DZ,QAAQ,CAAC,GAAG,CAAC;IACf;EACF,CAAC,EAAE,CAACC,YAAY,EAAED,QAAQ,CAAC,CAAC;EAE5B,oBACEH,OAAA;IAAKiC,SAAS,EAAC,yGAAyG;IAAAC,QAAA,eACtHlC,OAAA;MAAKiC,SAAS,EAAC,aAAa;MAAAC,QAAA,gBAC1BlC,OAAA;QAAKiC,SAAS,EAAC;MAA+E;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eACrGtC,OAAA;QAAGiC,SAAS,EAAC,6BAA6B;QAAAC,QAAA,EAAC;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC/D;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV;AAACpC,EAAA,CAxFuBD,qBAAqB;EAAA,QAC1BL,WAAW,EACLC,eAAe;AAAA;AAAA0C,EAAA,GAFhBtC,qBAAqB;AAAA,IAAAsC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}